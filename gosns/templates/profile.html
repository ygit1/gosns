{{define "content"}}
<div class="container">
    <div class="profile-header">
        <img src="{{.User.Avatar}}" alt="{{.User.Username}}" class="profile-avatar">
        <div class="profile-info">
            <h2>{{.User.Username}}</h2>
            <p>{{.User.Bio}}</p>
            <div class="profile-stats">
                <span><strong>{{.PostCount}}</strong> ÊäïÁ®ø</span>
                <span><strong>{{.FollowerCount}}</strong> „Éï„Ç©„É≠„ÉØ„Éº</span>
                <span><strong>{{.FollowingCount}}</strong> „Éï„Ç©„É≠„Éº‰∏≠</span>
            </div>
            {{if .IsOwnProfile}}
            <button class="btn btn-secondary" onclick="toggleEditProfile()">„Éó„É≠„Éï„Ç£„Éº„É´Á∑®ÈõÜ</button>
            {{else}}
            <button class="btn btn-primary follow-btn" data-user-id="{{.User.ID}}">
                {{if .IsFollowing}}„Éï„Ç©„É≠„ÉºËß£Èô§{{else}}„Éï„Ç©„É≠„Éº{{end}}
            </button>
            {{end}}
        </div>
    </div>

    {{if .IsOwnProfile}}
    <div id="edit-profile" class="edit-profile" style="display:none;">
        <h3>„Éó„É≠„Éï„Ç£„Éº„É´Á∑®ÈõÜ</h3>
        <form action="/profile/update" method="POST" enctype="multipart/form-data">
            <div class="form-group">
                <label for="bio">Ëá™Â∑±Á¥π‰ªã</label>
                <textarea id="bio" name="bio" rows="3">{{.User.Bio}}</textarea>
            </div>
            <div class="form-group">
                <label for="avatar">„Ç¢„Éê„Çø„ÉºÁîªÂÉè</label>
                <input type="file" id="avatar" name="avatar" accept="image/*">
            </div>
            <button type="submit" class="btn btn-primary">Êõ¥Êñ∞</button>
            <button type="button" class="btn btn-secondary" onclick="toggleEditProfile()">„Ç≠„É£„É≥„Çª„É´</button>
        </form>
    </div>
    {{end}}

    <div class="profile-posts">
        <h3>ÊäïÁ®ø</h3>
        {{range .Posts}}
        <div class="post" data-post-id="{{.ID}}">
            <div class="post-header">
                <img src="{{.Avatar}}" alt="{{.Username}}" class="avatar">
                <div class="post-info">
                    <strong>{{.Username}}</strong>
                    <span class="post-time">{{.CreatedAt.Format "2006-01-02 15:04"}}</span>
                </div>
            </div>
            <div class="post-content">
                <p>{{.Content}}</p>
                {{if .ImageURL}}
                <img src="{{.ImageURL}}" alt="ÊäïÁ®øÁîªÂÉè" class="post-image">
                {{end}}
            </div>
            <div class="post-actions">
                <button class="btn btn-sm like-btn" data-post-id="{{.ID}}">
                    ‚ù§Ô∏è <span class="like-count">{{.Likes}}</span>
                </button>
                <button class="btn btn-sm comment-btn" data-post-id="{{.ID}}">
                    üí¨ <span class="comment-count">{{.Comments}}</span>
                </button>
                {{if eq .UserID $.CurrentUserID}}
                <button class="btn btn-sm btn-danger delete-btn" data-post-id="{{.ID}}">ÂâäÈô§</button>
                {{end}}
            </div>
        </div>
        {{end}}
    </div>
</div>

<script>
function toggleEditProfile() {
    const editForm = document.getElementById('edit-profile');
    editForm.style.display = editForm.style.display === 'none' ? 'block' : 'none';
}
</script>
{{end}}